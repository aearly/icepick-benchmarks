# icepick benchmarks

Testing:

- Vanilla, mutable objects
- icepick
- seamless-immutable
- Immutable
- mori

With inputs:

- **small** - Object with 10 properties
- **large** - Object with 100 properties
- **huge** - Object with 1000 properties
- **smallNested** - Object with 10 properties, each an array of 10 objects with 10 properties
- **hugeNested** - Object with 10 properties, each an array of 100 objects with 100 properties

## Results

Tested in Node 8. All times in microseconds.

### Normal

```
create (µs)
┌───────────┬────────┬─────────┬──────────┬─────────────┬────────────┐
│           │ small  │ large   │ huge     │ smallNested │ hugeNested │
├───────────┼────────┼─────────┼──────────┼─────────────┼────────────┤
│ vanilla   │ 0.610  │ 0.074   │ 0.084    │ 0.073       │ 0.061      │
│ icepick   │ 11.576 │ 9.817   │ 133.667  │ 673.729     │ 7310.787   │
│ seamless  │ 7.062  │ 44.864  │ 292.685  │ 661.472     │ 48607.934  │
│ Immutable │ 15.219 │ 35.021  │ 377.007  │ 576.750     │ 76903.511  │
│ mori      │ 97.446 │ 181.848 │ 2068.615 │ 1581.292    │ 177807.773 │
└───────────┴────────┴─────────┴──────────┴─────────────┴────────────┘

access (µs)
┌───────────┬───────┬───────┬───────┬─────────────┬────────────┐
│           │ small │ large │ huge  │ smallNested │ hugeNested │
├───────────┼───────┼───────┼───────┼─────────────┼────────────┤
│ vanilla   │ 0.415 │ 0.232 │ 0.139 │ 0.190       │ 0.201      │
│ icepick   │ 0.218 │ 0.142 │ 0.146 │ 0.234       │ 0.198      │
│ seamless  │ 0.236 │ 0.191 │ 0.143 │ 0.196       │ 0.197      │
│ Immutable │ 1.205 │ 1.882 │ 1.453 │ 0.130       │ 0.133      │
│ mori      │ 1.119 │ 2.339 │ 0.961 │ 0.420       │ 0.385      │
└───────────┴───────┴───────┴───────┴─────────────┴────────────┘

assoc (µs)
┌───────────┬───────┬────────┬─────────┬─────────────┬────────────┐
│           │ small │ large  │ huge    │ smallNested │ hugeNested │
├───────────┼───────┼────────┼─────────┼─────────────┼────────────┤
│ vanilla   │ 0.346 │ 0.261  │ 0.193   │ 0.207       │ 0.213      │
│ icepick   │ 3.792 │ 41.637 │ 378.366 │ 3.407       │ 2.990      │
│ seamless  │ 7.342 │ 42.472 │ 270.903 │ 7.143       │ 6.297      │
│ Immutable │ 2.818 │ 2.245  │ 0.609   │ 0.547       │ 17.513     │
│ mori      │ 3.219 │ 4.840  │ 1.126   │ 1.225       │ 0.714      │
└───────────┴───────┴────────┴─────────┴─────────────┴────────────┘

dissoc (µs)
┌───────────┬────────┬────────┬─────────┬─────────────┬────────────┐
│           │ small  │ large  │ huge    │ smallNested │ hugeNested │
├───────────┼────────┼────────┼─────────┼─────────────┼────────────┤
│ vanilla   │ 0.289  │ 0.172  │ 0.173   │ 0.164       │ 0.166      │
│ icepick   │ 4.549  │ 49.045 │ 402.315 │ 4.088       │ 5.039      │
│ seamless  │ 10.781 │ 34.764 │ 238.797 │ 5.435       │ 4.925      │
│ Immutable │ 1.862  │ 2.399  │ 0.492   │ 0.260       │ 0.261      │
│ mori      │ 3.738  │ 5.651  │ 1.604   │ 0.649       │ 0.596      │
└───────────┴────────┴────────┴─────────┴─────────────┴────────────┘

accessNested (µs)
┌───────────┬───────┬───────┬──────┬─────────────┬────────────┐
│           │ small │ large │ huge │ smallNested │ hugeNested │
├───────────┼───────┼───────┼──────┼─────────────┼────────────┤
│ vanilla   │ N/A   │ N/A   │ N/A  │ 0.539       │ 0.568      │
│ icepick   │ N/A   │ N/A   │ N/A  │ 0.684       │ 0.340      │
│ seamless  │ N/A   │ N/A   │ N/A  │ 0.411       │ 0.483      │
│ Immutable │ N/A   │ N/A   │ N/A  │ 3.392       │ 0.932      │
│ mori      │ N/A   │ N/A   │ N/A  │ 3.555       │ 2.392      │
└───────────┴───────┴───────┴──────┴─────────────┴────────────┘

assocNested (µs)
┌───────────┬───────┬───────┬──────┬─────────────┬────────────┐
│           │ small │ large │ huge │ smallNested │ hugeNested │
├───────────┼───────┼───────┼──────┼─────────────┼────────────┤
│ vanilla   │ N/A   │ N/A   │ N/A  │ 0.680       │ 0.361      │
│ icepick   │ N/A   │ N/A   │ N/A  │ 13.862      │ 103.553    │
│ seamless  │ N/A   │ N/A   │ N/A  │ 28.725      │ 76.896     │
│ Immutable │ N/A   │ N/A   │ N/A  │ 4.925       │ 2.618      │
│ mori      │ N/A   │ N/A   │ N/A  │ 4.962       │ 4.692      │
└───────────┴───────┴───────┴──────┴─────────────┴────────────┘

thaw (µs)
┌───────────┬────────┬────────┬─────────┬─────────────┬────────────┐
│           │ small  │ large  │ huge    │ smallNested │ hugeNested │
├───────────┼────────┼────────┼─────────┼─────────────┼────────────┤
│ vanilla   │ 0.087  │ 0.083  │ 0.056   │ 0.053       │ 0.074      │
│ icepick   │ 2.312  │ 30.068 │ 382.242 │ 228.928     │ 31877.244  │
│ seamless  │ 1.285  │ 12.537 │ 172.999 │ 100.604     │ 12379.394  │
│ Immutable │ 4.481  │ 18.564 │ 138.690 │ 257.378     │ 17580.144  │
│ mori      │ 10.792 │ 79.773 │ 853.236 │ 675.055     │ 83744.344  │
└───────────┴────────┴────────┴─────────┴─────────────┴────────────┘

done
```


### `NODE_ENV=production`

```
create (µs)
┌───────────┬────────┬─────────┬──────────┬─────────────┬────────────┐
│           │ small  │ large   │ huge     │ smallNested │ hugeNested │
├───────────┼────────┼─────────┼──────────┼─────────────┼────────────┤
│ vanilla   │ 0.549  │ 0.078   │ 0.071    │ 0.078       │ 0.061      │
│ icepick   │ 0.139  │ 0.063   │ 0.054    │ 0.053       │ 0.064      │
│ seamless  │ 6.823  │ 46.986  │ 274.535  │ 525.733     │ 44330.754  │
│ Immutable │ 20.087 │ 39.765  │ 402.472  │ 599.021     │ 74684.474  │
│ mori      │ 81.681 │ 183.045 │ 2146.879 │ 1626.233    │ 177827.897 │
└───────────┴────────┴─────────┴──────────┴─────────────┴────────────┘

access (µs)
┌───────────┬───────┬───────┬───────┬─────────────┬────────────┐
│           │ small │ large │ huge  │ smallNested │ hugeNested │
├───────────┼───────┼───────┼───────┼─────────────┼────────────┤
│ vanilla   │ 0.409 │ 0.202 │ 0.141 │ 0.214       │ 0.210      │
│ icepick   │ 0.208 │ 0.208 │ 0.195 │ 0.304       │ 0.287      │
│ seamless  │ 0.211 │ 0.209 │ 0.146 │ 0.214       │ 0.210      │
│ Immutable │ 1.281 │ 2.234 │ 2.082 │ 0.133       │ 0.137      │
│ mori      │ 1.236 │ 3.959 │ 0.990 │ 0.456       │ 0.419      │
└───────────┴───────┴───────┴───────┴─────────────┴────────────┘

assoc (µs)
┌───────────┬───────┬────────┬─────────┬─────────────┬────────────┐
│           │ small │ large  │ huge    │ smallNested │ hugeNested │
├───────────┼───────┼────────┼─────────┼─────────────┼────────────┤
│ vanilla   │ 0.421 │ 0.219  │ 0.206   │ 0.223       │ 0.227      │
│ icepick   │ 2.152 │ 30.476 │ 372.315 │ 2.048       │ 1.723      │
│ seamless  │ 6.212 │ 39.809 │ 277.399 │ 5.883       │ 4.954      │
│ Immutable │ 3.004 │ 2.447  │ 0.726   │ 0.497       │ 0.955      │
│ mori      │ 4.417 │ 6.699  │ 4.985   │ 0.806       │ 1.328      │
└───────────┴───────┴────────┴─────────┴─────────────┴────────────┘

dissoc (µs)
┌───────────┬───────┬────────┬─────────┬─────────────┬────────────┐
│           │ small │ large  │ huge    │ smallNested │ hugeNested │
├───────────┼───────┼────────┼─────────┼─────────────┼────────────┤
│ vanilla   │ 0.288 │ 0.237  │ 0.172   │ 0.169       │ 0.171      │
│ icepick   │ 2.389 │ 35.805 │ 369.790 │ 2.145       │ 2.019      │
│ seamless  │ 5.489 │ 27.133 │ 204.415 │ 4.519       │ 4.157      │
│ Immutable │ 1.971 │ 2.552  │ 3.661   │ 0.267       │ 0.267      │
│ mori      │ 4.278 │ 4.491  │ 1.435   │ 0.605       │ 0.602      │
└───────────┴───────┴────────┴─────────┴─────────────┴────────────┘

accessNested (µs)
┌───────────┬───────┬───────┬──────┬─────────────┬────────────┐
│           │ small │ large │ huge │ smallNested │ hugeNested │
├───────────┼───────┼───────┼──────┼─────────────┼────────────┤
│ vanilla   │ N/A   │ N/A   │ N/A  │ 0.611       │ 0.326      │
│ icepick   │ N/A   │ N/A   │ N/A  │ 0.699       │ 0.329      │
│ seamless  │ N/A   │ N/A   │ N/A  │ 0.708       │ 0.338      │
│ Immutable │ N/A   │ N/A   │ N/A  │ 2.871       │ 0.899      │
│ mori      │ N/A   │ N/A   │ N/A  │ 3.055       │ 2.438      │
└───────────┴───────┴───────┴──────┴─────────────┴────────────┘

assocNested (µs)
┌───────────┬───────┬───────┬──────┬─────────────┬────────────┐
│           │ small │ large │ huge │ smallNested │ hugeNested │
├───────────┼───────┼───────┼──────┼─────────────┼────────────┤
│ vanilla   │ N/A   │ N/A   │ N/A  │ 0.669       │ 0.383      │
│ icepick   │ N/A   │ N/A   │ N/A  │ 6.393       │ 35.103     │
│ seamless  │ N/A   │ N/A   │ N/A  │ 21.894      │ 63.839     │
│ Immutable │ N/A   │ N/A   │ N/A  │ 4.564       │ 2.425      │
│ mori      │ N/A   │ N/A   │ N/A  │ 4.855       │ 3.833      │
└───────────┴───────┴───────┴──────┴─────────────┴────────────┘

thaw (µs)
┌───────────┬────────┬────────┬─────────┬─────────────┬────────────┐
│           │ small  │ large  │ huge    │ smallNested │ hugeNested │
├───────────┼────────┼────────┼─────────┼─────────────┼────────────┤
│ vanilla   │ 0.095  │ 0.052  │ 0.054   │ 0.058       │ 0.150      │
│ icepick   │ 0.595  │ 0.482  │ 0.501   │ 0.103       │ 0.177      │
│ seamless  │ 1.327  │ 13.777 │ 185.629 │ 96.589      │ 10269.735  │
│ Immutable │ 4.847  │ 11.976 │ 128.357 │ 281.566     │ 17607.203  │
│ mori      │ 12.274 │ 82.536 │ 987.923 │ 687.606     │ 98954.156  │
└───────────┴────────┴────────┴─────────┴─────────────┴────────────┘

done
```
